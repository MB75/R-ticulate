"\n\nGet started by typing and executing the function:"), writeLines("run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")", sep = "") )
}
rticulateStartupMessage()
rticulateStartupMessage <- function()
{
rticulate <- cat(message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).",
"\n\nGet started by typing and executing the function:"), writeLines("run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")", sep = " ") )
}
rticulateStartupMessage()
rticulateStartupMessage <- function()
{
rticulate <- cat(message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).",
"\n\nGet started by typing and executing the function:"), writeLines("run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")", sep = " ") , sep = " ")
}
rticulateStartupMessage()
cat("hi", "poopser")
rticulateStartupMessage <- function()
{
rticulate <- cat(message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).",
"\n\nGet started by typing and executing the function:"), "run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")")
}
rticulateStartupMessage()
rticulateStartupMessage <- function()
{
rticulate <- cat(message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).",
"\n\nGet started by typing and executing the function:"), "run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")", sep = "")
}
rticulateStartupMessage()
rticulateStartupMessage <- function()
{
rticulate <- cat(message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).",
"\n\nGet started by typing and executing the function:"), "run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")", sep = "", append = T)
}
rticulateStartupMessage()
rticulateStartupMessage <- function()
{
rticulate <- paste0(cat(message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).",
"\n\nGet started by typing and executing the function:")), "run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")")
}
rticulateStartupMessage()
rticulateStartupMessage <- function()
{
rticulate <- paste0(cat(message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).",
"\n\nGet started by typing and executing the function:")), cat("run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")"))
}
rticulateStartupMessage()
rticulateStartupMessage <- function()
{
rticulate <- cat(message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).",
"\n\nGet started by typing and executing the function:"), "run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")")
}
rticulateStartupMessage()
rticulateStartupMessage <- function()
{
rticulate <- cat(message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).",
"\n\nGet started by typing and executing the function:", "run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")"))
}
rticulateStartupMessage()
rticulateStartupMessage <- function()
{
rticulate <- cat(message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).",
"\n\nGet started by typing and executing the function: ", cat("run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")")))
}
rticulateStartupMessage()
rticulateStartupMessage <- function()
{
rticulate <- cat(message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).",
"\n\nGet started by typing and executing the function: ", print("run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")")))
}
rticulateStartupMessage()
rticulateStartupMessage <- function()
{
rticulate <- message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).",
"\n\nGet started by typing and executing the function: ", print("run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")"))
}
rticulateStartupMessage()
rticulateStartupMessage <- function()
{
rticulate <- message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).",
"\n\nGet started by typing and executing the function: ", cat("run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")"))
}
rticulateStartupMessage()
rticulateStartupMessage <- function()
{
rticulate <- message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).",
"\n\nGet started by typing and executing the function: ", "run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")")
}
rticulateStartupMessage()
rticulateStartupMessage <- function()
{
rticulate <- cat(message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).",
"\n\nGet started by typing and executing the function: "), "run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")", sep = " ")
}
rticulateStartupMessage()
rticulateStartupMessage <- function()
{
rticulate <- cat(message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).",
"\n\nGet started by typing and executing the function: "), "run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")", sep = "")
}
rticulateStartupMessage()
rticulateStartupMessage <- function()
{
rticulate <- cat(message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).\nThis package contains interactive exercises and the standard error function se() (type ?se to view the help page).",
"\n\nGet started by typing and executing the function: "), "run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")", sep = "")
}
rticulateStartupMessage()
?se
?se
rticulateStartupMessage <- function()
{
rticulate <- cat(message(r"(
______      _________  __  _______   __    __  __        __       _________  ________
/ ___  |    /________/ / / / _____/  / /   / / / /       /  \     /________/ / ______/
/ /__/ /        / /    / / / /       / /   / / / /       / /\ \       / /    / /_____
/ _  __/  ===   / /    / / / /       / /   / / / /       / /__\ \     / /    / ______/
/ / \ \         / /    / / / /_____  / /___/ / / /_____  / /————\ \   / /    / /_____
/_/   \_\       /_/    /_/  \______/  \______/  \______/ /_/      \_\ /_/     \______/
)",
"\nCompanion package to \"R-ticulate — A Beginner's Guide to Data Analysis for Natural Scientists\" by Martin Bader and Sebastian Leuzinger (first edition 2024, ISBN: 978-1-119-71799-7).\nThis package contains interactive exercises and the standard error function se() (type ?se to view the help page).",
"\n\nGet started by running the following code: "), "run_tutorial(name = \"Chapter_01\", package = \"Rticulate\")", sep = "")
}
rticulateStartupMessage()
remove.packages("Rticulate")
run_tutorial(name = "Chapter_01", package = "Rticulate")
remove.pacakges("Rticulate")
remove.packages("Rticulate")
## Read in the leaf respiration data "leaf_respiration_3.csv", available on the book webpage
lr3 <- read.csv("leaf_respiration_3.csv")
setwd("/Users/mabaab/Downloads/Book_exercises/Datasets")
## Read in the leaf respiration data "leaf_respiration_3.csv", available on the book webpage
lr3 <- read.csv("leaf_respiration_3.csv")
head(lr3)
## Use the best model (see Chapter 9.2.2)
m7 <- lm(leafresp ~ temp * sla, data = lr3)
## Load packages
library(ggplot2)
library(metR)
library(viridisLite)
library(MBA)
library(reshape2)
## Create a new data frame providing a fine grid of predictor values to predict from
newdat <- with(lr3, data.frame(sla = seq(min(sla), max(sla), length.out = 200), temp = seq(min(temp), max(temp), length.out = 200)))
newdat$fit <- predict(m7, newdata = newdat)
## Assign new variable names to comply with the xyz matrix notation of the three dimensions
names(newdat) <- c("x", "y", "z")
## Surface approximation using multilevel B-splines (multilevel means a coarse to fine hierarchy is applied)
dat.surf <- mba.surf(xyz = newdat, no.X = 500, no.Y = 500, extend = T) # spline approximation (approximation is superior to interpolation when it comes to smoothing away randomness in the data, see interpolation example below). One can use b.box = c(0.5, 12.5, 0, 24) to extrapolate beyond the x-limits.
dimnames(dat.surf$xyz.est$z) <- list(dat.surf$xyz.est$x, dat.surf$xyz.est$y)
dat.surf
## Convert the matrix output of the mba.surf into a data frame (long format) for plotting with ggplot2
dat.mba <- reshape2::melt(dat.surf$xyz.est$z, varnames = c("sla", "temp"), value.name = "leafresp")
tail(dat.mba, n = 3)
## Create the colour-contour plot with ggplot
p1 <- ggplot(data = dat.mba, aes(x = sla, y = temp, z = leafresp)) +
geom_raster(aes(fill = leafresp), interpolate = T) +
# scale_fill_gradientn(name = expression(paste(atop(NA, atop(textstyle("Leaf respiration"), textstyle(paste("(", mu, "mol", " m"^-2, " s"^-1, ")")))))), colours = turbo(n = 200)) +
scale_fill_gradientn(name = expression(paste(atop(NA, atop(textstyle("Leaf respiration"), textstyle(paste("(", mu, "mol", " m"^-2, " s"^-1, ")")))))), colours = grey.colors(n = 100, start = 0, end = 1, rev = T)) +
geom_contour2(aes(z = leafresp, label = after_stat(level)), linewidth = 0.2, colour = "grey15", label_size = 3) +
scale_y_continuous(name = expression(paste("Leaf temperature (", degree, "C)")), limits = c(min(dat.mba$temp), max(dat.mba$temp)), expand = c(0, 0)) +
scale_x_continuous(name = expression(paste("SLA (m"^2, " kg"^-1, ")")), breaks = seq(0, 20, by = 5), limits = c(min(dat.mba$sla), max(dat.mba$sla)), expand = c(0, 0)) +
theme_bw() +
theme(legend.title = element_text(size = 11),
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 11, margin = margin(t = 4.5)),
axis.text.y = element_text(size = 11, margin = margin(r = 4)),
axis.title.x = element_text(size = 13, margin = margin(t = 4)),
axis.title.y = element_text(size = 13, margin = margin(r = 4.5)))
p1
## Create the colour-contour plot with ggplot
p1 <- ggplot(data = dat.mba, aes(x = sla, y = temp, z = leafresp)) +
geom_raster(aes(fill = leafresp), interpolate = T) +
scale_fill_gradientn(name = expression(paste(atop(NA, atop(textstyle("Leaf respiration"), textstyle(paste("(", mu, "mol", " m"^-2, " s"^-1, ")")))))), colours = turbo(n = 200)) +
geom_contour2(aes(z = leafresp, label = after_stat(level)), linewidth = 0.2, colour = "grey15", label_size = 3) +
scale_y_continuous(name = expression(paste("Leaf temperature (", degree, "C)")), limits = c(min(dat.mba$temp), max(dat.mba$temp)), expand = c(0, 0)) +
scale_x_continuous(name = expression(paste("SLA (m"^2, " kg"^-1, ")")), breaks = seq(0, 20, by = 5), limits = c(min(dat.mba$sla), max(dat.mba$sla)), expand = c(0, 0)) +
theme_bw() +
theme(legend.title = element_text(size = 11),
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 11, margin = margin(t = 4.5)),
axis.text.y = element_text(size = 11, margin = margin(r = 4)),
axis.title.x = element_text(size = 13, margin = margin(t = 4)),
axis.title.y = element_text(size = 13, margin = margin(r = 4.5)))
p1
## Surface approximation using multilevel B-splines (multilevel means a coarse to fine hierarchy is applied)
dat.surf <- mba.surf(xyz = newdat, no.X = 500, no.Y = 500, extend = T, b.box = c(0, 30, 0, 25)) # spline approximation (approximation is superior to interpolation when it comes to smoothing away randomness in the data, see interpolation example below). One can use b.box = c(0, 30, 0, 25) to extrapolate beyond the x-limits.
dimnames(dat.surf$xyz.est$z) <- list(dat.surf$xyz.est$x, dat.surf$xyz.est$y)
## Convert the matrix output of the mba.surf into a data frame (long format) for plotting with ggplot2
dat.mba <- reshape2::melt(dat.surf$xyz.est$z, varnames = c("sla", "temp"), value.name = "leafresp")
tail(dat.mba, n = 3)
## Create the colour-contour plot with ggplot
p1 <- ggplot(data = dat.mba, aes(x = sla, y = temp, z = leafresp)) +
geom_raster(aes(fill = leafresp), interpolate = T) +
scale_fill_gradientn(name = expression(paste(atop(NA, atop(textstyle("Leaf respiration"), textstyle(paste("(", mu, "mol", " m"^-2, " s"^-1, ")")))))), colours = turbo(n = 200)) +
geom_contour2(aes(z = leafresp, label = after_stat(level)), linewidth = 0.2, colour = "grey15", label_size = 3) +
scale_y_continuous(name = expression(paste("Leaf temperature (", degree, "C)")), limits = c(min(dat.mba$temp), max(dat.mba$temp)), expand = c(0, 0)) +
scale_x_continuous(name = expression(paste("SLA (m"^2, " kg"^-1, ")")), breaks = seq(0, 20, by = 5), limits = c(min(dat.mba$sla), max(dat.mba$sla)), expand = c(0, 0)) +
theme_bw() +
theme(legend.title = element_text(size = 11),
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 11, margin = margin(t = 4.5)),
axis.text.y = element_text(size = 11, margin = margin(r = 4)),
axis.title.x = element_text(size = 13, margin = margin(t = 4)),
axis.title.y = element_text(size = 13, margin = margin(r = 4.5)))
p1
## Surface approximation using multilevel B-splines (multilevel means a coarse to fine hierarchy is applied)
dat.surf <- mba.surf(xyz = newdat, no.X = 500, no.Y = 500, extend = T, b.box = c(2.5, 30, 0, 25)) # spline approximation (approximation is superior to interpolation when it comes to smoothing away randomness in the data, see interpolation example below). One can use b.box = c(0, 30, 0, 25) to extrapolate beyond the x-limits.
dimnames(dat.surf$xyz.est$z) <- list(dat.surf$xyz.est$x, dat.surf$xyz.est$y)
## Convert the matrix output of the mba.surf into a data frame (long format) for plotting with ggplot2
dat.mba <- reshape2::melt(dat.surf$xyz.est$z, varnames = c("sla", "temp"), value.name = "leafresp")
tail(dat.mba, n = 3)
## Create the colour-contour plot with ggplot
p1 <- ggplot(data = dat.mba, aes(x = sla, y = temp, z = leafresp)) +
geom_raster(aes(fill = leafresp), interpolate = T) +
scale_fill_gradientn(name = expression(paste(atop(NA, atop(textstyle("Leaf respiration"), textstyle(paste("(", mu, "mol", " m"^-2, " s"^-1, ")")))))), colours = turbo(n = 200)) +
geom_contour2(aes(z = leafresp, label = after_stat(level)), linewidth = 0.2, colour = "grey15", label_size = 3) +
scale_y_continuous(name = expression(paste("Leaf temperature (", degree, "C)")), limits = c(min(dat.mba$temp), max(dat.mba$temp)), expand = c(0, 0)) +
scale_x_continuous(name = expression(paste("SLA (m"^2, " kg"^-1, ")")), breaks = seq(0, 20, by = 5), limits = c(min(dat.mba$sla), max(dat.mba$sla)), expand = c(0, 0)) +
theme_bw() +
theme(legend.title = element_text(size = 11),
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 11, margin = margin(t = 4.5)),
axis.text.y = element_text(size = 11, margin = margin(r = 4)),
axis.title.x = element_text(size = 13, margin = margin(t = 4)),
axis.title.y = element_text(size = 13, margin = margin(r = 4.5)))
p1
library(Rticulate)
roxygen2::roxygenise()
roxygen2::roxygenise(package.dir = "/Users/mabaab/Library/CloudStorage/OneDrive-Linnéuniversitetet/Dokument/Rticulate")
setwd("~/Library/CloudStorage/OneDrive-Linnéuniversitetet/Dokument/Rticulate")
remove.packages("Rticulate")
roxygen2::roxygenise()
## Load required packages
library(devtools)
install_github("https://github.com/MB75/R-ticulate")
remove.packages("learnr")
remove.packages("relaimpo")
## Load required packages
library(devtools)
install_github("https://github.com/MB75/R-ticulate")
roxygen2::roxygenise()
remove.packages("Rticulate")
## Load required packages
library(devtools)
install_github("https://github.com/MB75/R-ticulate")
library(Rticulate)
library(Rticulate)
library(rpart)
library(Rticulate)
roxygen2::roxygen()
roxygen2::roxygenise()
roxygen2::roxygenise()
## Load the 'devtools' package
library(devtools)
install_github("MB75/R-ticulate")
library(Rticulate)
library(Rticulate)
run_tutorial(name = "Chapter_08", package = "Rticulate")
## Load the 'devtools' package
library(devtools)
install_github("MB75/R-ticulate")
library(Rticulate)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
## List of packages required for this tutorial
# pkgs <- c("learnr", "kableExtra", "ggplot2", "ggcorrplot")
#
# ## Check whether the specified package is available
#   inst.pack <- rownames(installed.packages()) # list of installed packages
#   if (length(setdiff(x = pkgs, y = inst.pack)) > 0) { # setdiff() returns the elements of x that don't occur in y
#     install.packages(setdiff(pkgs, inst.pack), repos = "https://cloud.r-project.org", dependencies = T)
#   }
## Load required packages
library(learnr)
library(kableExtra)
library(MASS)
library(ggplot2)
library(ggcorrplot)
corr <- round(cor(diamonds[, c(1, 5:7)]), digits = 1)
ggcorrplot(corr, method = "circle", type = "upper")
ggcorrplot(cor(swiss, method = "spearman"), method = "circle", type = "upper", lab = T)
cor(swiss, method = "spearman")
cor(swiss$Fertility, swiss$Infant.Mortality)
## Provide datasets
# Offspring size
set.seed(20653)
x <- (round(rnorm(n = 30, mean = 15, sd = 1), digits = 1))
y <- (round(rnorm(n = 30, mean = 15, sd = 1), digits = 1))
bugs <- data.frame(mother = x, offspring = y)
plot(offspring ~ mother, data = bugs)
cor.test(bugs$mother, bugs$offspring)
## For multiple-choice questions
## Significant but weak correlation
# for (i in 1:100000) {
#   set.seed(i)
#   x <- rnorm(n = 150, sd = 10)
#   y <- rnorm(n = 150, mean = 10, sd = 15)
#   ct <- cor.test(x, y)
# if(ct$p.value < 0.05 & abs(ct$estimate) < 0.2) print(i)
# }
#
#   set.seed(94874) # 97622, 97488, 91111
#   x <- rnorm(n = 150, sd = 10)
#   y <- rnorm(n = 150, mean = 10, sd = 15)
# cor.test(x, y)
## Strong but statistically insignificant correlation
# for (i in 1:100000) {
#   set.seed(i)
#   x <- rnorm(n = 10, sd = 10)
#   y <- rnorm(n = 10, mean = 10, sd = 10)
#   ct <- cor.test(x, y)
# if(abs(ct$estimate) > 0.6 && ct$p.value > 0.05) print(i)
# }
#
# set.seed(99503) # 99948
#   x <- rnorm(n = 10, sd = 10)
#   y <- rnorm(n = 10, mean = 10, sd = 10)
# (ct <- cor.test(x, y))
#   abs(ct$estimate)
## Plant health scores for Spearman or Kendall correlation analysis
set.seed(4862)
scores <- sample(x = 1:5, size = 40, replace = T)
health.scores <- data.frame(staff1 = scores[1:20], staff2 = scores[21:40])
## Air quality indes (AQI)
aqi <- data.frame(rainfall = c(50, 40, 60, 30, 70)-25, airquality.index = c(44, 42, 50, 33, 52))
## Transformation data example
set.seed(6448)
x <- round(rnorm(n = 30, mean = 10), 2)
y <- x + rnorm(30, 5)
y <- round(y^15/10^17, digits = 2)
trans <- data.frame(x = x, y = y)
## View the first few observations
head(bugs)
remove.packages("Rticulate")
## Load the 'devtools' package
library(devtools)
install_github("MB75/R-ticulate")
library(Rticulate)
remove.packages("Rticulate", lib="~/Library/R/arm64/4.4/library")
install_github("MB75/R-ticulate")
library(Rticulate)
detach("package:Rticulate", unload = TRUE)
library(Rticulate)
run_tutorial(name = "Chapter_08", package = "Rticulate")
remove.packages("Rticulate", lib="~/Library/R/arm64/4.4/library")
## Load the 'devtools' package
library(devtools)
install_github("MB75/R-ticulate")
library(Rticulate)
run_tutorial(name = "Chapter_12", package = "Rticulate")
run_tutorial(name = "Chapter_12", package = "Rticulate")
remove.packages("Rticulate", lib="~/Library/R/arm64/4.4/library")
## Load the 'devtools' package
library(devtools)
install_github("MB75/R-ticulate")
library(Rticulate)
run_tutorial(name = "Chapter_12", package = "Rticulate")
detach("package:Rticulate", unload = TRUE)
remove.packages("Rticulate", lib="~/Library/R/arm64/4.4/library")
## Load the 'devtools' package
library(devtools)
install_github("MB75/R-ticulate")
library(Rticulate)
detach("package:Rticulate", unload = TRUE)
remove.packages("Rticulate", lib="~/Library/R/arm64/4.4/library")
install_github("MB75/R-ticulate")
## Load the 'devtools' package
library(devtools)
install_github("MB75/R-ticulate")
library(Rticulate)
remove.packages("Rticulate", lib="~/Library/R/arm64/4.4/library")
remove.packages("learnr", lib="~/Library/R/arm64/4.4/library")
## Load the 'devtools' package
library(devtools)
install_github("MB75/R-ticulate")
library(Rticulate)
git remote add origin https://github.com/MB75/R-ticulate
remove.packages("Rticulate")
